<!DOCTYPE html>
<html>
<head>
	<meta http-equiv='X-UA-Compatible' content='IE=edge' />
	<meta http-equiv='content-type' content='text/html; charset=utf-8'/>

	<style type='text/css'>
		body, div, p, table {
			font-size:10pt;
			font-family:Verdana;
		}

		img{border:none}
		
	</style>
	
</head>

<body>
<h1>Плагин Snippets</h1>
<p>Версия 1.0</p>
<h2>Содержание</h2>
<ul>
<ul>
<li><a href="#brief">Краткое описание</a></li>
<li><a href="#management">Управление шаблонами</a></li>
<li><a href="#enter">Вставка шаблонного текста</a></li>
<li><a href="#wikicommand">Вставка шаблона в виде викикоманды</a></li>
<li><a href="#language">Язык шаблонов</a></li>
<ul>
<li><a href="#var">Задание переменных</a></li>
<li><a href="#globalvar">Встроенные переменные</a></li>
<li><a href="#blocks">Другие языковые конструкции</a></li>
<ul>
<li><a href="#if">Оператор if</a></li>
<li><a href="#include">Оператор include</a></li>
</ul>
</ul>
<li><a href="#advanced">Особенности хранения шаблонов</a></li>
<li><a href="#contacts">Ссылки и контакты</a></li>
</ul>
</ul>
<h2><a id="brief"></a> Краткое описание</h2>
<p>Плагин Snippets предназначен для сохранения шаблонного текста, который часто используется в заметках, для того, чтобы каждый раз не набирать повторяющийся текст заново. В тексте шаблона могут встречаться переменные подстановки, значения которых вводится пользователем при использовании шаблона. Кроме того, если вы знакомы с шаблонизатором <a href="http://jinja.pocoo.org/">Jinja2</a>, то можете использовать его возможности в шаблонах, поскольку плагин Snippets использует эту библиотеку для генерации текста по шаблону.</p>
<p><div align="center"><a href="__attach/snippets_rus_vardialog_snippet.png"><img src="__attach/__thumb/th_width_700_snippets_rus_vardialog_snippet.png"/></a></div></p>
<h2><a id="management"></a> Управление шаблонами</h2>
<p>Чтобы создать шаблон, выберите пункт меню "Шаблоны - Управление шаблонами...", откроется диалог "Управление шаблонами". В левой части диалога будет показано дерево шаблонов, в котором шаблоны можно группировать по папкам.</p>
<p><div align="center"><a href="__attach/snippets_rus_management.png"><img src="__attach/__thumb/th_width_700_snippets_rus_management.png"/></a></div></p>
<p>В верхней части диалога расположена панель инструментов с двумя группами кнопок.</p>
<p>В левую группу входят кнопки для создания папки шаблонов, создания нового шаблона, переименования папки или шаблона, удаления шаблона, запуска шаблона на выполнение.</p>
<p>В правую группу входят кнопка для вставки встроенных или пользовательских переменных, а также кнопка для вставки некоторых <a href="#language">языковых конструкций Jinja</a> в текст шаблона.</p>
<p>Если во введенном шаблоне есть синтаксическая ошибка, то она выводится в правом нижнем информационном поле.</p>
<p>Все шаблоны при редактировании сохраняются автоматически, поэтому в диалоге нет кнопки для сохранения шаблона.</p>
<p>Все созданные шаблоны помещаются в меню "Шаблоны" главного окна программы OutWiker, а созданные папки с шаблонами в этом меню представлены вложенными подменю. Вложенность папок практически не ограничена.</p>
<p><div align="center"><img src="__attach/snippets_rus_menu_snippets.png"/></div></p>
<h2><a id="enter"></a> Вставка шаблонного текста</h2>
<p>Плагин Snippets позволяет вставлять шаблоны в двух режимах - в виде сгенерированного текста и в виде викикоманды (этот режим работает только для викистраниц).</p>
<p>Чтобы вставить шаблон в текст страницы, нужно выбрать соответствующий шаблон в меню "Шаблоны" или запустить на выполнение шаблон из диалога управлением шаблонами. После этого откроется диалог для ввода значений переменных. В левой части диалога будут перечислены переменные, которые необходимо ввести (при желании, их значения можно оставить пустыми), а справа можно увидеть результат, который будет вставлен в текст страницы, и исходный текст шаблона.</p>
<p><div align="center"><a href="__attach/snippets_rus_vardialog_result.png"><img src="__attach/__thumb/th_width_600_snippets_rus_vardialog_result.png"/></a></div></p>
<p><div align="center"><a href="__attach/snippets_rus_vardialog_snippet.png"><img src="__attach/__thumb/th_width_600_snippets_rus_vardialog_snippet.png"/></a></div></p>
<p>В левом нижнем углу диалога расположен переключатель "Вставить как викикоманду". Если он <b>не установлен</b>, то полученный результат будет непосредственно вставлен в текст страницы. Если этот переключатель <b>установлен</b>, то в текст страницы будет вставлена <a href="#wikicommand">викикоманда</a>, которая будет преобразована в соответствующий текст в режиме просмотра. Переключатель "Вставить как викикоманду" существует только в том случае, если выбранная в данный момент страница является викистраницей (а не HTML-страницей, текстовой страницей и т.д.)</p>
<h2><a id="wikicommand"></a> Вставка шаблона в виде викикоманды</h2>
<p>Если в <a href="#enter">диалоге ввода переменных</a> установить переключатель "Вставить как викикоманду", то в текст страницы будет вставлен не сгенерированный текст, а викикоманда (:snip:), которая будет преобразована в соответствующий текст в режиме просмотра. Эта команда имеет следующий формат:</p>

<pre>
(:snip file=&quot;Папка с шаблоном/имя шаблона&quot; varname1=&quot;значение переменной&quot;, varname2=&quot;значение переменной&quot;, ...:)
Необязательный текст
(:snipend:)
</pre>

<p>Если задан параметр <i>file</i>, то используется шаблон, указанный в качестве значения этого параметра. Путь до шаблона задается относительно корневой папки шаблона, т.е. если шаблон с именем "Мой шаблон" виден непосредственно в меню "Шаблоны", то значение параметра <i>file</i> должно быть равно "Мой шаблон". Если "Мой шаблон" находится в подменю "Шаблоны - Папка с шаблонами", то значение параметра <i>file</i> должно быть равно "Папка с шаблонами/Мой шаблон". При этом в пути всегда используются прямые слеши (/).</p>
<p><i>varname1</i>, <i>varname2</i> и т.д. - имена переменных, встречающихся в тексте шаблона, а "Необязательный текст" будет сохранен во <a href="#globalvar">встроенную переменную</a> <i>__text</i>, которая может использоваться в шаблоне.</p>
<p>В этом случае переменная <i>__text</i> будет хранить текст между (:snip:) и (:snipend:), т.е. в данном примере значение "Необязательный текст".</p>
<p>Если в викикоманде (:snip:) параметр <i>file</i> не задан, то считается, что текст шаблона задан между (:snip:) и (:snipend:):</p>

<pre>
(:snip varname1=&quot;значение переменной&quot;, varname2=&quot;значение переменной&quot;, ...:)
Текст шаблона
(:snipend:)
</pre>

<p>В этом случае <a href="#globalvar">встроенная переменная</a> <i>__text</i> будет равна пустой строке "".</p>
<h2><a id="language"></a> Язык шаблонов</h2>
<p>В шаблонах используется язык из библиотеки-шаблонизатора <a href="http://jinja.pocoo.org/">jinja2</a>. Это очень мощная библиотека, но в данном разделе будут перечислены только наиболее простые и часто используемые в шаблонах возможности. Интерфейс плагина Snippets рассчитан на пользователя, незнакомого с этой библиотекой, однако если вы программист и работали с ней, то вы можете использовать все ее возможности, о которых здесь не будет упомянуто. Описание всех возможностей этой библиотеки вы можете найти в <a href="http://jinja.pocoo.org/docs/dev/templates/">документации к Jinja2</a>.</p>
<h3><a id="var"></a> Задание переменных</h3>
<p>Наиболее важная часть синтаксиса шаблонов - это переменные. Значение переменной в шаблоне вставляется с помощью конструкции {{<i>varname</i>}}, где <i>varname</i> - это имя переменной. Из-за особенности используемой библиотеки имя переменной может включать в себя только латинские буквы, цифры и знак подчеркивания "_", причем первым символом в имени переменной может быть только латинская буква.</p>
<p>В плагине Snippets есть набор встроенных переменных, которые нельзя задать через диалог ввода переменных, их значения зависят от свойств текущей страницы или текущей даты. Полный список таких переменных перечислен в разделе <a href="#variables">Встроенные переменные</a>. Эти переменные начинаются с символа двойного подчеркивания.</p>
<p>Рассмотрим такой шаблон:</p>

<pre>
from outwiker.core.commands import MessageBox

MessageBox(
    _(u'{{message}}'),
    _(u'{{title}}'),
    wx.ICON_ERROR | wx.OK)
</pre>

<p>В нем используются две переменные: <i>message</i> и <i>title</i>, плагин Snippets попросит их определить в открывшемся диалоге при вызове данного шаблона:</p>
<p><div align="center"><a href="__attach/snippets_rus_vardialog_result.png"><img src="__attach/__thumb/th_width_600_snippets_rus_vardialog_result.png"/></a></div></p>
<h3><a id="globalvar"></a>Встроенные переменные</h3>
<p>Кроме заданных пользователем переменных, плагин Snippets создает набор встроенных переменных, значения которых зависят от свойств текущей страницы. Имена всех встроенных переменные начинаются с двух знаков подчеркивания.</p>
<p>Имена встроенных переменных можно увидеть в диалоге управления шаблонами, если нажать кнопку для вставки переменных.</p>
<p><div align="center"><a href="__attach/snippets_rus_globalvar.png"><img src="__attach/__thumb/th_width_600_snippets_rus_globalvar.png"/></a></div></p>
<p>Например. Переменная <i>__text</i> содержит в себе текст, выделенный на странице в момент вызова шаблона. Также переменная <i>__text</i> используется при работе <a href="#wikicommand">викикоманды</a> (:snip:), которая вставляет шаблон из файла (если задан параметр <i>file</i>). В этом случае переменная <i>__text</i> содержит текст, находящийся между (:snip:) и (:snipend:).</p>
<p>Переменная <i>__type</i> равна значению <i>wiki</i> для викистраниц, <i>html</i> для страниц в формате HTML, <i>text</i> для простых текстовых страниц и т.д. Эту переменную вместе с <a href="#if">оператором if</a> можно использовать для изменения поведения шаблона в зависимости от типа страницы.</p>
<h3><a id="blocks"></a> Другие языковые конструкции</h3>
<p>Используемая внутри плагина Snippets библиотека <a href="http://jinja.pocoo.org/">Jinja2</a> поддерживает достаточно большое количество языковых конструкций, но через интерфейс плагина можно вставить только некоторые из них. Если вы знакомы с данной библиотекой, то можете использовать все поддерживаемые ей конструкции.</p>
<p>Через интерфейс можно вставить три языковые конструкции: операторы <i><a href="#if">if</a></i>, <i><a href="#include">include</a></i> и комментарии.</p>
<p><div align="center"><a href="__attach/snippets_rus_blocks.png"><img src="__attach/__thumb/th_width_600_snippets_rus_blocks.png"/></a></div></p>
<p>Комментарии обрамляются скобками вида {# ... #} и во время обработки шаблона удаляются. Они нужны, чтобы пояснить текст шаблона - для чего он используется, что означают переменные и т.п.</p>
<h4><a id="if"></a> Оператор if</h4>
<p>Оператор <i>if</i> предназначен для организации ветвления в шаблоне и вставки текста, зависящего от значений переменных. Синтаксис оператора <i>if</i> следующий:</p>

<pre>
{% if условие_1 %}
    Текст 1
{% elif условие_2 %}
    Текст 2
{% elif условие_3 %}
    Текст 3
...
{% else %}
    Текст N.
{% endif %}
</pre>

<p>Скорее всего подобная конструкция вам знакома по какому-либо языку программирования.</p>
<p>Обратите внимание, что все переменные кроме тех, что содержат даты, являются строковыми переменными, поэтому их значения нужно сравнивать именно со строками, даже если подразумевается, что переменная будет содержать только цифры. Поэтому правильное выражение может быть такое:</p>

<pre>
{% if var == '1' %}100{% elif var == '2' %}200{% elif var == '3' %}300{% else %}xxx{% endif %}
</pre>

<p>А такое выражение будет <b>ошибочно</b> (всегда будет выполняться ветвь <i>else</i>):</p>

<pre>
{% if var == 1 %}100{% elif var == 2 %}200{% elif var == 3 %}300{% else %}xxx{% endif %}
</pre>

<h4><a id="include"></a> Оператор include</h4>
<p>Оператор <i>include</i> предназначен для вставки одного шаблона в другой, при этом во вставляемом шаблоне могут быть объявлены собственные переменные. Синтаксис оператора <i>include</i> следующий:</p>

<pre>
{% include &quot;Вставляемый шаблон&quot; %}
</pre>

<p>В этом операторе "Вставляемый шаблон" - это имя шаблона, который должен находиться в той же папке, что и родительский шаблон (внутри которого находится оператор <i>include</i>) или во вложенной папке, в этом случае оператор будет выглядеть следующим образом:</p>

<pre>
{% include &quot;Папка 1/Папка 2/Вставляемый шаблон&quot; %}
</pre>

<h2><a id="advanced"></a> Особенности хранения шаблонов </h2>
<p>Все шаблоны хранятся в виде отдельных файлов в папке <i>snippets</i> внутри директории с настройками программы (под Windows 7 / 8.x / 10 - C:\Users\USERNAME\AppData\Roaming\outwiker\snippets\, под Linux - /home/USERNAME/.config/outwiker/snippets/). Имя шаблона соответствует имени файла, поэтому чаще всего это будут файлы без расширения. Папки в шаблонах - это обычные папки в той же директории <i>snippets</i>.</p>
<h2><a id="contacts"></a> Ссылки и контакты</h2>
<ul>
<li><a href="http://jenyay.net/Outwiker/Snippets">Страница плагина</a></li>
<li>Замеченные ошибки, пожелания и предложения пишите на почту <a href="mailto:jenyay.ilin@gmail.com">jenyay.ilin@gmail.com</a></li>
</ul>
</body>
</html>
